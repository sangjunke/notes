##工作中遇到的通用函数封装(多出自摘抄博客等，谢大佬)
### js移动端 emoji表情转化
```javascript
//将emoji表情转化为字符串
function utf16toEntities(str) {
    var patt=/[\ud800-\udbff][\udc00-\udfff]/g; // 检测utf16字符正则
    str = str.replace(patt, function(char){
        var H, L, code;
        if (char.length===2) {
            H = char.charCodeAt(0); // 取出高位
            L = char.charCodeAt(1); // 取出低位
            code = (H - 0xD800) * 0x400 + 0x10000 + L - 0xDC00; // 转换算法
            return "&#" + code + ";";
        } else {
            return char;
        }
    });
    return str;
}
//将字符串转化为emoji表情
function uncodeUtf16(str){
    var reg = /\&#.*?;/g;
    var result = str.replace(reg,function(char){
        var H,L,code;
        if(char.length == 9 ){
            code = parseInt(char.match(/[0-9]+/g));
            H = Math.floor((code-0x10000) / 0x400)+0xD800;
            L = (code - 0x10000) % 0x400 + 0xDC00;
            return unescape("%u"+H.toString(16)+"%u"+L.toString(16));
        }else{
            return char;
        }
    });
    return result;
}
//截取链接带的信息  给iframe链接地址传值  iframe 内接受
		function GetJRequest() {
			var urlinfo = window.location.href; //获取当前页面的url
			var len = urlinfo.length; //获取url的长度
			var offset = urlinfo.indexOf("?"); //设置参数字符串开始的位置
			if(offset <= 0)
				return;
			var newsidinfo = urlinfo.substr(offset + 1, len) //取出参数字符串 这里会获得类似“id=1”这样的字符串
			var values = newsidinfo.split('&');
			len = values.length;
			var valHash = new Array();
			if(values.length > 0) {
				for(var i = 0; i < len; i++) {
					var keys = values[i].split('=');
					if(keys.length > 1) {

						valHash[keys[0]] = keys[1];
					}
				}
			}
			return valHash;
		}
//上传图片函数 基于jquery
//上传封装
// headers={{authorization:jwt.ticker,module:'ad',key:"66"}}
function aUpload(url, data, module, ajaxfn) {
	//			layer.msg("正在上传···");
	$.ajax({
		url: url,
		type: 'POST',
		data: data || {},
		async: true,
		headers: {
			Authorization: ticker,
			module: module,
			key: "66"
		},
		//               mimeType:"multipart/form-data",
		processData: false,
		contentType: false,
		dataType: 'json',
		success: function(data) {
			ajaxfn(data);
			if(data.status == 1) {
				//						layer.msg("上传成功");
			}
		},
		error: function(data) {
			//					layer.msg("上传失败");
			ajaxfn(data);
		}
	})
}

;(function (event) {
			var formData = new FormData();
            $('.headUpload').change(function () {
            	layer.msg("正在上传···",{time:Math.pow(10000,2)});//layer弹窗提示
            	var oldTime=0;
            	var timer=setInterval(function(){//设置十五秒超时
       					oldTime+=1;
       					if(oldTime>=15){
       						layer.alert("上传超时");
       						clearInterval(timer)
       						}
       				},1000)
                var imgArr = []; //获取的图片地址
                var fileList = $(this)[0].files;   //或获取的图片文件
                var Length = fileList.length;
                for ( var i = 0; i < Length; i++ ) {
                    var imgUrl = window.URL.createObjectURL(fileList[i]); //获取图片地址
               		formData.append("file",fileList[0])
                   	aUpload(
                   		config.imageApi+"api/Upload/UploadImage",
                   		formData,
                   		"info",
               			function(data){//回调函数
               				clearInterval(timer)
               				uploadBack(data)
               				if(data.status==1){
        //					上传成功后 
               					var img=data.data;
//				                    	图片路径传到后台
										jgyAjax(
											config.webapi+"api/UserInfo/ModifyIcon",
											{userID:user,iconPath:data.data},
											"post",
											true,
											function(data){
												checkStatus(data)
												if(data.status==1){
													var $img = $("<img class='img img-transform' src='"+img+"'>");
							                   				 $('.imgBox').html($img);
							                   				 setTimeout(function () {
							                   				 	imgMiddle()
							                   				 }, 100)
													}
											},
											headers
										)
									formData = new FormData();
				                   
               				}else{
               					formData = new FormData();
               				}

               			}
                   	)
   
                }
            });
})()
//时间转化函数
function updateTime1(str) {
			let time = str;
			let unixtime = time
			let unixTimestamp = new Date(unixtime * 1000)
			let Y = unixTimestamp.getFullYear()
			let M = ((unixTimestamp.getMonth() + 1) > 10 ? (unixTimestamp.getMonth() + 1) : '0' + (unixTimestamp.getMonth() + 1))
			let D = (unixTimestamp.getDate() > 10 ? unixTimestamp.getDate() : '0' + unixTimestamp.getDate())
			let toDay = Y + '/' + M + '/' + D
			return toDay
		}
//获取当前时间
function getTime() {
			var date = new Date();
			var month = date.getMonth() + 1;
			var day = date.getDate();
			var today = new Array('星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六');
			var week = today[date.getDay()];
			$('.sjk-month').text(month + '月');//几月
			$('.sjk-day').text(day);//几号
			$('.time-day').text(week);//星期几
		}
//判断内核
var mobile_bs = {
		versions: function() {
			var u = navigator.userAgent;
			return {
				trident: u.indexOf('Trident') > -1, //IE内核
				presto: u.indexOf('Presto') > -1, //opera内核
				webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
				gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
				mobile: !!u.match(/AppleWebKit.*Mobile.*/) || !!u.match(/AppleWebKit/) && u.indexOf('QIHU') && u.indexOf('QIHU') > -1 && u.indexOf('Chrome') < 0, //是否为移动终端
				ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
				android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
				iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者QQHD浏览器
				iPad: u.indexOf('iPad') > -1, //是否iPad
				webApp: u.indexOf('Safari') == -1 //是否web应该程序，没有头部与底部
			}
		}()
	};
//rem移动端
window.onload=function(){
    resize(750,"x");
}
function resize(originSize,type){
    // originSize = 750;
    // type = x
    type = type || "x";
    if(type=="x"){
        var width = document.documentElement.clientWidth;//设备的宽度
        var scale = width/originSize*100+"px";
        document.getElementsByTagName("html")[0].style.fontSize=scale;
    }else if(type=="y"){
        var height = document.documentElement.clientHeight;
        var scale = height/originSize+"px";
        document.getElementsByTagName("html")[0].style.fontSize=scale;
    }
}
resize(750,"x");

window.onresize = function(){
   resize(750,"x");
}
//
```